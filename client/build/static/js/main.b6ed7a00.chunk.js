(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{23:function(e,t,a){e.exports=a(34)},34:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(20),s=a.n(c),l=a(4),o=a(2),i=a(1),u=a(22),m=a(6),d={authOk:!1,name:"",thumbnail:"",products:[],alert:"",cart:[]},f=function(e,t){switch(t.type){case"USER_LOGIN":return Object(m.a)(Object(m.a)(Object(m.a)({},e),t.data),{},{alert:t.message||"",authOk:!0});case"USER_LOGOUT":return Object(m.a)(Object(m.a)({},d),{},{alert:t.message||""});case"ALERT_MESSAGE":return Object(m.a)(Object(m.a)({},e),{},{alert:t.message});case"ALERT_CLEAR":return Object(m.a)(Object(m.a)({},e),{},{alert:""});case"UPDATE_PRODUCTS":return Object(m.a)(Object(m.a)({},e),{},{products:t.products,alert:t.message||""});case"CART_ADD":var a=Object(u.a)(e.cart),n=t.id,r=t.num,c=a.findIndex((function(e){return e.id===n}));return c>-1?a[c].num++:a.push({id:n,num:r}),console.log("[CART_ADD] adding ".concat(n," num(").concat(r,") state.cart:"),a),Object(m.a)(Object(m.a)({},e),{},{cart:a});default:return console.log("Invalid action type: ".concat(t.type)),e}},p=Object(n.createContext)(),E=function(){return Object(n.useContext)(p)},b=function(e){var t=Object(n.useReducer)(f,d),a=Object(i.a)(t,2),c=a[0],s=a[1];return r.a.createElement(p.Provider,Object.assign({value:[c,s]},e))},g=a(3),v=a.n(g),h=a(7);var O,j=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"get",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n={method:t=t.toLowerCase(),headers:{"Content-Type":"application/json",Session:localStorage.session||""}};return"post"!==t&&"put"!==t||(n.body=JSON.stringify(a)),fetch(e,n).then((function(e){return e.json()}))};var w=function(){var e=E(),t=Object(i.a)(e,2),a=t[0],c=a.authOk,s=a.name,u=a.thumbnail,m=a.cart,d=t[1],f=Object(n.useState)(!1),p=Object(i.a)(f,2),b=p[0],g=p[1],w=Object(n.useState)(0),y=Object(i.a)(w,2),x=y[0],k=y[1],S=Object(o.f)();function R(){return(R=Object(h.a)(v.a.mark((function e(){var t,a,n,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j("/api/users/session");case 2:if(t=e.sent,a=t.status,n=t.userData,r=t.message,console.log("[NavBar] attempted to reload session, result(".concat(a,") message(").concat(r,")")),a){e.next=11;break}return localStorage.session="",d({type:"ALERT_MESSAGE",message:r}),e.abrupt("return");case 11:d({type:"USER_LOGIN",data:n});case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){b&&(O&&clearTimeout(O),O=setTimeout((function(){g(!1)}),2e3))}),[b]),Object(n.useEffect)((function(){O&&clearTimeout(O),g(!1)}),[S]),Object(n.useEffect)((function(){console.log(".. updating cart num: ",m.reduce((function(e,t){return e+t.num}),0)),k(m.reduce((function(e,t){return e+t.num}),0))}),[m]),Object(n.useEffect)((function(){36!==localStorage.session.length||c||function(){R.apply(this,arguments)}()}),[]),r.a.createElement(r.a.Fragment,null,36===localStorage.session.length||c?r.a.createElement("nav",{class:"navbar navbar-expand-lg navbar-light bg-light"},r.a.createElement(l.c,{to:"/",className:"navbar-brand"},r.a.createElement("img",{src:"https://upload.wikimedia.org/wikipedia/commons/7/79/Mountain_icon_%28Noun_Project%29.svg",alt:"mountain icon",width:"64",height:"64"})),r.a.createElement("button",{onClick:function(){return g(!b)},class:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbar"},r.a.createElement("span",{class:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse "+(b?"show":""),id:"navbar"},r.a.createElement("ul",{class:"navbar-nav me-auto mb-2 mb-lg-0"},r.a.createElement("li",{className:"nav-item"},r.a.createElement(l.c,{to:"/products",className:"nav-link",activeClassName:"active"},"Product List")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(l.c,{to:"/products/add",className:"nav-link",activeClassName:"active"},"Product Add")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(l.c,{to:"/settings",className:"nav-link",activeClassName:"active"},"Settings")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(l.c,{to:"/cart",className:"nav-link",activeClassName:"active"},r.a.createElement("i",{class:"fas fa-shopping-cart"})," Cart ",x>0&&r.a.createElement("span",{class:"badge rounded-pill bg-warning text-dark"},x))),r.a.createElement("li",{className:"nav-item"},r.a.createElement(l.c,{to:"/logout",className:"nav-link"},"Logout"))),u&&r.a.createElement("div",{class:"d-flex"},r.a.createElement("div",{class:"mx-3"},r.a.createElement("img",{src:u,id:"navThumbnail",alt:"user thumbnail",width:"64",height:"64"}))),!u&&s&&r.a.createElement("div",{class:"d-flex"},r.a.createElement("div",{class:"mx-3"},"Welcome back ",r.a.createElement("u",null,s))))):r.a.createElement(o.a,{to:"/login"}))};var y,x=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("hr",null),r.a.createElement("div",{id:"footer-padding"}),r.a.createElement("div",{id:"footer"},"(c) Everest Team"))};var k=function(){var e=E(),t=Object(i.a)(e,2),a=t[0].alert,c=t[1];function s(){y&&clearTimeout(y),c({type:"ALERT_CLEAR"})}return Object(n.useEffect)((function(){a&&(y&&clearTimeout(y),y=setTimeout(s,3e3))}),[a]),r.a.createElement(r.a.Fragment,null,a&&r.a.createElement("div",{onClick:s,class:"navbar fixed-top alert alert-warning mx-5"},a))};var S=function(e){return r.a.createElement("div",{key:e._id,className:"card mx-auto col-4 mb-3"},r.a.createElement("button",{onClick:function(t){return e.cartAdd(t,e._id,1)},class:"btn btn-sm btn-outline-secondary"},r.a.createElement("i",{class:"fas fa-cart-plus"})),r.a.createElement(l.b,{to:"/products/info/"+e._id},r.a.createElement("img",{className:"card-img-top",src:e.image,alt:e.description,title:e.description}),r.a.createElement("div",{className:"card-body"},r.a.createElement("h4",{className:"card-title"},e.heading),r.a.createElement("p",{className:"card-text"},e.price))),"s")};var R=function(){var e=E(),t=Object(i.a)(e,2),a=t[0],c=a.alert,s=a.products,l=a.name,o=t[1],u=Object(n.useRef)();function m(){return(m=Object(h.a)(v.a.mark((function e(){var t,a,n,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j("/api/products");case 2:if(t=e.sent,a=t.status,n=t.products,r=t.message,console.log("[productsLoad] status(".concat(a,") message(").concat(r,") userProducts:"),n),a){e.next=10;break}return o({type:"ALERT_MESSAGE",message:r}),e.abrupt("return");case 10:o({type:"UPDATE_PRODUCTS",products:n});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e,t,a){e.preventDefault(),o({type:"CART_ADD",id:t,num:a})}function f(){return(f=Object(h.a)(v.a.mark((function e(t){var a,n,r,c,s;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=u.current.value,u.current.value="",e.next=5,j("/api/products","post",{task:a});case 5:if(n=e.sent,r=n.status,c=n.products,s=n.message,r){e.next=12;break}return o({type:"ALERT_MESSAGE",message:s}),e.abrupt("return");case 12:o({type:"UPDATE_PRODUCTS",products:c,message:s});case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){console.log("[Products] mount"),function(){m.apply(this,arguments)}()}),[]),r.a.createElement("form",null,r.a.createElement("div",{class:"card"},r.a.createElement("div",{class:"card-header"},r.a.createElement("h1",null,l,"'s Product List")),r.a.createElement("div",{class:"card-body row"},s&&s.map((function(e){return r.a.createElement(S,Object.assign({cartAdd:d},e))}))),r.a.createElement("div",{class:"card-footer"},r.a.createElement("div",{class:"input-group"},r.a.createElement("input",{ref:u,type:"text",class:"form-control",placeholder:"New Task..."}),r.a.createElement("button",{onClick:function(e){return f.apply(this,arguments)},disabled:c.length>0,class:"btn btn-primary"},"Save")))))};var A=function(e){var t=["*","*","*","*","*"].map((function(t,a){return'<i class="'.concat(e.rating>a?"fas fa-star text-warning":"far fa-star text-secondary",'"></i>')}));return r.a.createElement("div",{dangerouslySetInnerHTML:{__html:t.join("")}})};var N=function(e){return r.a.createElement("form",null,r.a.createElement("div",{class:"form-group"},r.a.createElement("label",{for:"formName"},"Email"),r.a.createElement("input",{type:"email",class:"form-control",id:"formName",placeholder:"name@example.com"})),r.a.createElement("div",{class:"form-group"},r.a.createElement("label",{for:"formRating"},"Rating..."),r.a.createElement("select",{class:"form-control",id:"formRating"},r.a.createElement("option",null,"1"),r.a.createElement("option",null,"2"),r.a.createElement("option",null,"3"),r.a.createElement("option",null,"4"),r.a.createElement("option",null,"5"))),r.a.createElement("div",{class:"form-group"},r.a.createElement("label",{for:"formReview"},"Your Review"),r.a.createElement("textarea",{class:"form-control",id:"formReview",rows:"3"})),r.a.createElement("button",{class:"btn btn-lg btn-primary",onClick:e.saveForm},"Save Review"))};var L=function(e){var t=Object(n.useState)(!1),a=Object(i.a)(t,2),c=a[0],s=a[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement("hr",null),r.a.createElement("ul",{class:"list-group"},e.reviews?e.reviews.map((function(e){return r.a.createElement("li",{class:"list-group-item"},r.a.createElement("div",{class:"row"},r.a.createElement("div",{class:"col-8"},r.a.createElement("b",null,e.name)),r.a.createElement("div",{class:"col-4 pull-right"},r.a.createElement(A,{rating:e.rating}))),e.review)})):"<li>No reviews yet</li>"),c?r.a.createElement(N,{saveForm:function(e){e.preventDefault(),s(!1)}}):r.a.createElement("div",{class:"d-flex justify-content-end"},r.a.createElement("button",{class:"btn btn-lg btn-secondary",onClick:function(){return s(!0)}},r.a.createElement("i",{class:"fas fa-grin-stars"})," Add Review")))};var T=function(){var e=E(),t=Object(i.a)(e,2),a=t[0].cart,c=t[1],s=Object(o.g)().id,l=Object(n.useState)([]),u=Object(i.a)(l,2),d=u[0],f=u[1],p=Object(n.useState)(0),b=Object(i.a)(p,2),g=b[0],O=b[1];function w(){return(w=Object(h.a)(v.a.mark((function e(t){var a,n,r,s;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j("/api/products/".concat(t));case 2:if(a=e.sent,n=a.status,r=a.products,s=a.message,n&&1===r.length){e.next=9;break}return c({type:"ALERT_MESSAGE",message:s}),e.abrupt("return");case 9:f(r[0]);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){1===a.filter((function(e){return e.id===s})).length&&O(a.filter((function(e){return e.id===s}))[0].num)}),[a]),Object(n.useEffect)((function(){!function(e){w.apply(this,arguments)}(s)}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{class:"row mt-3"},r.a.createElement("div",{class:"col-4"},r.a.createElement("img",{src:d.image,class:"img-thumbnail"})),r.a.createElement("div",{class:"col-8"},r.a.createElement("h1",null,d.heading),r.a.createElement("h2",null,d.price),r.a.createElement("h3",null,r.a.createElement(A,{rating:d.rating})),r.a.createElement("button",{onClick:function(){console.log("[cartAdd] called..."),c(Object(m.a)({type:"CART_ADD",id:s,num:1},d))},class:"btn btn-lg btn-primary"},r.a.createElement("i",{class:"fas fa-cart-plus"}))," (",g,")"),r.a.createElement("p",{class:"mx-3 mt-3"},d.description)),r.a.createElement(L,{id:d.id,reviews:d.reviews}))};var _=function(e){return r.a.createElement("div",null,"[Product Add]")};var C,P=function(){var e=E(),t=Object(i.a)(e,2),a=t[0].authOk,c=t[1],s=Object(n.useRef)(),u=Object(n.useRef)(),m=Object(n.useRef)(),d=Object(n.useRef)();function f(){return(f=Object(h.a)(v.a.mark((function e(t){var a,n,r,l,o,i;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),d.current.checkValidity()){e.next=4;break}return d.current.classList.add("was-validated"),e.abrupt("return");case 4:if(!((a={name:m.current.value.trim(),email:s.current.value.trim(),password:u.current.value.trim()}).name.length<3||a.email.indexOf("@")<3||a.password.length<8)){e.next=9;break}return m.current.focus(),c({type:"ALERT_MESSAGE",message:"Please complete your reg info"}),e.abrupt("return");case 9:return e.next=11,j("/api/users/register","post",a);case 11:if(n=e.sent,r=n.status,l=n.session,o=n.userData,i=n.message,r){e.next=20;break}return localStorage.session="",c({type:"ALERT_MESSAGE",message:i}),e.abrupt("return");case 20:localStorage.session=l,c({type:"USER_LOGIN",data:o,message:i});case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){s.current.value=localStorage.email||""}),[]),r.a.createElement(r.a.Fragment,null,a?r.a.createElement(o.a,{to:"/tasks"}):"",r.a.createElement("form",{ref:d},r.a.createElement("div",{class:"card mt-5"},r.a.createElement("div",{class:"card-header"},r.a.createElement("h1",null,"User Registration")),r.a.createElement("div",{class:"card-body"},r.a.createElement("div",{class:"mb-3"},r.a.createElement("label",{for:"name"},"First Name"),r.a.createElement("input",{ref:m,type:"text",id:"name",class:"form-control",required:!0}),r.a.createElement("div",{class:"invalid-feedback"},"Please enter a name")),r.a.createElement("div",{class:"mb-3"},r.a.createElement("label",{for:"email"},"Email Address"),r.a.createElement("input",{ref:s,id:"email",type:"email",class:"form-control",required:!0}),r.a.createElement("div",{class:"invalid-feedback"},"Please enter an email")),r.a.createElement("div",{class:"mb-3"},r.a.createElement("label",{for:"userPassword"},"Password"),r.a.createElement("input",{ref:u,id:"userPassword",type:"password",class:"form-control",pattern:".{8,}",required:!0}),r.a.createElement("div",{class:"invalid-feedback"},"Please enter a password (8 chars min)"))),r.a.createElement("div",{class:"card-footer"},r.a.createElement("button",{onClick:function(e){return f.apply(this,arguments)},class:"btn btn-primary mx-1"},"Register"),r.a.createElement(l.b,{to:"/login",class:"font-weight-light text-muted mx-3"},"Already Registered?")))))},D=window.location.protocol+"//"+window.location.host.replace("localhost:3000","localhost:8080"),M=!1;var G=function(e){function t(e){if(!M){var t=window.innerWidth/2-300,a=window.innerHeight/2-300,n="".concat(D,"/oauth/").concat(e);console.log("[openOAuth] opening url: ".concat(n)),C=window.open(n,"","toolbar=no, location=no, directories=no, status=no, menubar=no, \n          scrollbars=no, resizable=no, copyhistory=no, width=".concat(600,", \n          height=").concat(600,", top=").concat(a,", left=").concat(t)),M=!0,function(){var e=setInterval((function(){C&&!C.closed&&void 0!==C.closed||(clearInterval(e),M=!1)}),1e3)}()}}Object(n.useEffect)((function(){window.addEventListener("message",(function(t){if(t&&t.data&&"string"===typeof t.data&&"{"===t.data.substr(0,1)&&"}"===t.data.substr(-1,1)){var a=JSON.parse(t.data);console.log("<< from popup window, received:",a),C&&C.close(),e.userLoginComplete&&e.userLoginComplete(a)}}),!1)}),[]);var a={facebook:"fa-facebook-square",twitter:"fa-twitter-square",google:"fa-google-plus-square",github:"fa-github-square",linkedin:"fa-linkedin"};return r.a.createElement("div",{class:"card"},r.a.createElement("div",{class:"card-body d-flex justify-content-center"},e.providers.map((function(e){return r.a.createElement("button",{onClick:function(){return t(e)},class:"btn btn-outline-secondary",style:{marginRight:"10px"}},r.a.createElement("i",{className:"fab ".concat(a[e]," fa-3x")}))}))))};var U=function(){var e=E(),t=Object(i.a)(e,2),a=t[0].authOk,c=t[1],s=Object(n.useRef)(),u=Object(n.useRef)(),m=Object(n.useRef)(),d=Object(n.useRef)();function f(e){var t=e.status,a=e.session,n=e.userData,r=e.message;if(console.log("[userLoginSave] data:",n),!t)return localStorage.session="",void c({type:"ALERT_MESSAGE",message:r});localStorage.session=a,c({type:"USER_LOGIN",data:n})}function p(){return(p=Object(h.a)(v.a.mark((function e(t){var a,n,r,l,o,i;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),console.log("[userLogin]"),d.current.checkValidity()){e.next=5;break}return d.current.classList.add("was-validated"),e.abrupt("return");case 5:if(!((a={email:s.current.value,password:u.current.value,rememberMe:m.current.checked}).email.indexOf("@")<3||a.password.length<8)){e.next=10;break}return s.current.focus(),c({type:"ALERT_MESSAGE",message:"Please complete your form!"}),e.abrupt("return");case 10:return e.next=12,j("/api/users/login","post",a);case 12:n=e.sent,r=n.status,l=n.session,o=n.userData,i=n.message,m&&m.current.checked?localStorage.email=s.current.value:localStorage.email="",f({status:r,session:l,userData:o,message:i});case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){s.current.value=localStorage.email||"",m.current.checked=!0}),[]),r.a.createElement(r.a.Fragment,null,a?r.a.createElement(o.a,{to:"/products"}):"",r.a.createElement("form",{ref:d},r.a.createElement("div",{class:"card mt-5"},r.a.createElement("div",{class:"card-header"},r.a.createElement("h1",null,"Login")),r.a.createElement("div",{class:"card-body"},r.a.createElement("div",{class:"mb-3"},r.a.createElement("label",{for:"email",class:"form-label"},"Email address"),r.a.createElement("input",{ref:s,id:"email",type:"email",class:"form-control",required:!0}),r.a.createElement("div",{class:"invalid-feedback"},"Please enter your login email")),r.a.createElement("div",{class:"mb-3"},r.a.createElement("label",{for:"userPassword"},"Password"),r.a.createElement("input",{ref:u,id:"userPassword",type:"password",class:"form-control",pattern:".{8,}",required:!0}),r.a.createElement("div",{class:"invalid-feedback"},"Please enter your password (8 chars min)"))),r.a.createElement("div",{class:"card-footer"},r.a.createElement("button",{onClick:function(e){return p.apply(this,arguments)},type:"button",class:"btn btn-primary mx-1"},"Login"),"\xa0",r.a.createElement("input",{ref:m,id:"rememberMe",type:"checkbox"}),r.a.createElement("label",{class:"text-secondary",for:"rememberMe"},"Remember Me")," \xa0",r.a.createElement(l.b,{to:"/register",class:"mx-3"},"Need to Register?")),r.a.createElement(G,{providers:["twitter","facebook","github","google","linkedin"],userLoginComplete:f}))))};var F=function(){var e=E(),t=Object(i.a)(e,2),a=t[0].authOk,c=t[1];function s(){return(s=Object(h.a)(v.a.mark((function e(){var t,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j("/api/users/logout");case 2:t=e.sent,a=t.message,localStorage.session="",c({type:"USER_LOGOUT",message:a});case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){!function(){s.apply(this,arguments)}()}),[]),r.a.createElement(r.a.Fragment,null,!a&&r.a.createElement(o.a,{to:"/login"}),r.a.createElement("h1",null,"Please wait, logging out..."))};var I=function(e){return r.a.createElement("li",{class:"list-group-item d-flex justify-content-between align-items-center"},r.a.createElement(l.b,{to:"/products/"+e.id},r.a.createElement("img",{class:"img-thumbnail",src:e.image,alt:e.heading,width:"64",height:"64"}),r.a.createElement("span",{class:"mx-3"},e.heading)),r.a.createElement("span",{class:"badge rounded-pill bg-warning text-dark float-end"},e.num))};var q=function(e){var t=E(),a=Object(i.a)(t,1)[0],c=a.products,s=a.cart,l=Object(n.useState)([]),o=Object(i.a)(l,2),u=o[0],d=o[1];return Object(n.useEffect)((function(){d(s.map((function(e){return Object(m.a)(Object(m.a)({},e),c.filter((function(t){return t._id===e.id}))[0])})))}),[]),r.a.createElement("ul",{key:e.heading,class:"list-group"},u.map((function(e){return r.a.createElement(I,e)})))};var J=function(e){return r.a.createElement(r.a.Fragment,null,"[SettingsPage]")};var B=function(){return r.a.createElement(b,null,r.a.createElement(l.a,null,r.a.createElement("div",{class:"container"},r.a.createElement(k,null),r.a.createElement(w,null),r.a.createElement(o.b,{exact:!0,path:["/","/products"],component:R}),r.a.createElement(o.b,{exact:!0,path:"/products/add",component:_}),r.a.createElement(o.b,{exact:!0,path:"/products/info/:id",component:T}),r.a.createElement(o.b,{exact:!0,path:"/cart",component:q}),r.a.createElement(o.b,{exact:!0,path:"/settings",component:J}),r.a.createElement(o.b,{exact:!0,path:"/register",component:P}),r.a.createElement(o.b,{exact:!0,path:"/login",component:U}),r.a.createElement(o.b,{exact:!0,path:"/logout",component:F}),r.a.createElement(x,null))))};s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(B,null)),document.getElementById("root"))}},[[23,1,2]]]);
//# sourceMappingURL=main.b6ed7a00.chunk.js.map