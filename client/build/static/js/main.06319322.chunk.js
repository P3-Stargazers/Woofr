(this.webpackJsonpeverest=this.webpackJsonpeverest||[]).push([[0],{22:function(e,t,a){e.exports=a(34)},27:function(e,t,a){},34:function(e,t,a){"use strict";a.r(t);var n,r=a(0),c=a.n(r),l=a(19),s=a.n(l),o=(a(27),a(2)),i=a(10),m=a(1),u=a(8),p=c.a.createContext();function d(e,t){switch(t.type){case"addToCart":var a=Object(u.a)({},e),n=a.cart.findIndex((function(e){return e.id==t.id}));return n>-1?(console.log("[dispatcher:".concat(t.type,"] cart.num(").concat(a.cart[n].num,") += (").concat(t.num,")")),a.cart[n].num+=t.num):a.cart.push(Object(u.a)({},t)),console.log("[GlobalStore:addToCart] id(".concat(t.id,") cartItemIdx(").concat(n,")"),a),a;default:console.log("crap sorry, dunno what to do")}}function g(e){var t=Object(r.useReducer)(d,{cart:[]}),a=Object(m.a)(t,2),n=a[0],l=a[1];return c.a.createElement(p.Provider,Object.assign({value:[n,l]},e))}function f(){return Object(r.useContext)(p)}var b=function(){var e=Object(r.useState)(!1),t=Object(m.a)(e,2),a=t[0],l=t[1],s=Object(r.useState)(localStorage.session),u=Object(m.a)(s,1)[0],p=f(),d=Object(m.a)(p,1)[0],g=Object(i.f)();a&&(clearTimeout(n),n=setTimeout((function(){l(!1)}),5e3));var b=!(u&&36===u.length)&&!("/login"===g.pathname||"/register"===g.pathname),E=d.cart.reduce((function(e,t){return e+t.num}),0);return c.a.createElement(c.a.Fragment,null,b?c.a.createElement(i.a,{to:"/login"}):"",c.a.createElement("nav",{class:"navbar navbar-expand-lg navbar-light bg-light"},c.a.createElement(o.b,{to:"/",className:"navbar-brand"},c.a.createElement("img",{src:"https://upload.wikimedia.org/wikipedia/commons/7/79/Mountain_icon_%28Noun_Project%29.svg",alt:"",style:{width:"64px",height:"64px"}})),c.a.createElement("button",{onClick:function(){return l(!a)},class:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},c.a.createElement("span",{class:"navbar-toggler-icon"})),c.a.createElement("div",{className:"collapse navbar-collapse "+(a?"show":""),id:"navbarSupportedContent"},c.a.createElement("ul",{class:"navbar-nav mr-auto"},c.a.createElement("li",{className:"nav-item"},c.a.createElement(o.b,{to:"/productlist",className:"/productlist"===g.pathname?"nav-link active":"nav-link"},"Product List")),c.a.createElement("li",{className:"nav-item"},c.a.createElement(o.b,{to:"/productadd",className:"/productadd"===g.pathname?"nav-link active":"nav-link"},"Product Add")),c.a.createElement("li",{className:"nav-item"},c.a.createElement(o.b,{to:"/settings",className:"/settings"===g.pathname?"nav-link active":"nav-link"},"Settings")),c.a.createElement("li",{className:"nav-item"},c.a.createElement(o.b,{to:"/cart",className:"/cart"===g.pathname?"nav-link active":"nav-link"},E?c.a.createElement("span",{class:"badge badge-pill badge-success"},c.a.createElement("i",{class:"fas fa-shopping-cart"})," ",E):"")),localStorage.session?c.a.createElement("li",{className:"nav-item"},c.a.createElement(o.b,{to:"/logout",className:"nav-link"},"Logout")):c.a.createElement("li",{className:"nav-item"},c.a.createElement(o.b,{to:"/login",className:"nav-link"},"Login"))))))},E=a(4),v=a.n(E),h=a(7);var y=function(e){return c.a.createElement("div",{key:e.heading,className:"card mx-auto col-4"},c.a.createElement(o.b,{to:"/productinfo/"+e.id},c.a.createElement("img",{className:"card-img-top",src:e.image,alt:e.description,title:e.description}),c.a.createElement("div",{className:"card-body"},c.a.createElement("h4",{className:"card-title"},e.heading),c.a.createElement("p",{className:"card-text"},e.price))))};var j={get:function(e){return fetch(e,{headers:{Session:localStorage.session}}).then((function(e){return e.json()}))},post:function(e,t){return fetch(e,{method:"post",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json",Session:localStorage.session},body:JSON.stringify(t)}).then((function(e){return e.json()}))}};var w=function(e){var t=Object(r.useState)([]),a=Object(m.a)(t,2),n=a[0],l=a[1];function s(){return(s=Object(h.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.get("/api/product/list");case 2:t=e.sent,l(t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useEffect)((function(){!function(){s.apply(this,arguments)}()}),[]),c.a.createElement("div",{class:"row"},n.map((function(e){return c.a.createElement(y,e)})))};var O=function(e){for(var t="",a=1;a<=5;a++)t+=e.rating>=a?'<i class="fas fa-star text-warning"></i>':'<i class="far fa-star"></i>';return c.a.createElement("div",{dangerouslySetInnerHTML:{__html:t}})};var x=function(e){return c.a.createElement("form",null,c.a.createElement("div",{class:"form-group"},c.a.createElement("label",{for:"formName"},"Email"),c.a.createElement("input",{type:"email",class:"form-control",id:"formName",placeholder:"name@example.com"})),c.a.createElement("div",{class:"form-group"},c.a.createElement("label",{for:"formRating"},"Rating..."),c.a.createElement("select",{class:"form-control",id:"formRating"},c.a.createElement("option",null,"1"),c.a.createElement("option",null,"2"),c.a.createElement("option",null,"3"),c.a.createElement("option",null,"4"),c.a.createElement("option",null,"5"))),c.a.createElement("div",{class:"form-group"},c.a.createElement("label",{for:"formReview"},"Your Review"),c.a.createElement("textarea",{class:"form-control",id:"formReview",rows:"3"})),c.a.createElement("button",{class:"btn btn-lg btn-primary",onClick:e.saveForm},"Save Review"))};var k=function(e){var t=Object(r.useState)(!1),a=Object(m.a)(t,2),n=a[0],l=a[1];return console.log("[ProductReviews] showForm=",n),c.a.createElement(c.a.Fragment,null,c.a.createElement("hr",null),n?c.a.createElement(x,{saveForm:function(e){e.preventDefault(),l(!1)}}):c.a.createElement("div",{class:"d-flex justify-content-end"},c.a.createElement("button",{class:"btn btn-lg btn-secondary",onClick:function(){l(!0)}},c.a.createElement("i",{class:"fas fa-grin-stars"})," Review")),c.a.createElement("ul",{class:"list-group"},e.reviews?e.reviews.map((function(e){return c.a.createElement("li",{class:"list-group-item"},c.a.createElement("div",{class:"row"},c.a.createElement("div",{class:"col-8"},c.a.createElement("b",null,e.name)),c.a.createElement("div",{class:"col-4 pull-right"},c.a.createElement(O,{rating:e.rating}))),e.review)})):"<li>No reviews yet</li>"))};var S=function(e){var t=Object(i.g)().id,a=Object(r.useState)([]),n=Object(m.a)(a,2),l=n[0],s=n[1],o=f(),p=Object(m.a)(o,2),d=(p[0],p[1]);function g(){return(g=Object(h.a)(v.a.mark((function e(t){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.get("/api/product/".concat(t));case 2:a=e.sent,s(a);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useEffect)((function(){!function(e){g.apply(this,arguments)}(t)}),[]),c.a.createElement("div",{class:"container"},c.a.createElement("div",{class:"row"},c.a.createElement("div",{class:"col-4"},c.a.createElement("img",{src:l.image,class:"img-thumbnail"})),c.a.createElement("div",{class:"col-8"},c.a.createElement("h1",null,l.heading),c.a.createElement("h2",null,l.price),c.a.createElement("h3",null,c.a.createElement(O,{rating:l.rating})),c.a.createElement("button",{onClick:function(){d(Object(u.a)({type:"addToCart",id:t,num:1},l))},class:"btn btn-lg btn-primary"},c.a.createElement("i",{class:"fas fa-cart-plus"}))),l.description),c.a.createElement(k,{id:l.id,reviews:l.reviews}))};var N=function(e){return c.a.createElement(c.a.Fragment,null,"[SettingsPage]")};var R=function(e){return c.a.createElement("div",null,"[Product Add]")};var C=function(e){return c.a.createElement("li",{class:"list-group-item d-flex justify-content-between align-items-center"},c.a.createElement(o.b,{to:"/productinfo/"+e.id},c.a.createElement("img",{class:"img-thumbnail",src:e.image,style:{width:"64px",height:"64px"}}),e.heading),c.a.createElement("span",{class:"badge badge-secondary badge-pill pull-right"},e.num))};var P=function(e){var t=Object(r.useState)([]),a=Object(m.a)(t,2),n=(a[0],a[1],f()),l=Object(m.a)(n,2),s=l[0];return l[1],c.a.createElement("ul",{key:e.heading,class:"list-group"},s.cart.map((function(e){return c.a.createElement(C,e)})))},T=a(12);var M=function(){var e=Object(r.useState)({name:"",email:"",password:""}),t=Object(m.a)(e,2),a=t[0],n=t[1],l=Object(r.useState)(!1),s=Object(m.a)(l,2),o=s[0],p=s[1],d=Object(r.useState)({type:"",message:""}),g=Object(m.a)(d,2),f=g[0],b=g[1],E=Object(r.useRef)(),y=Object(r.useRef)();function j(e){var t=e.target,r=t.id,c=t.value;n(Object(u.a)({},a,Object(T.a)({},r,c)))}function w(){return(w=Object(h.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),""!==a.email){e.next=5;break}return E.current.focus(),b({type:"danger",message:"Please provide your Email!"}),e.abrupt("return");case 5:if(/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(a.email)){e.next=9;break}return E.current.focus(),b({type:"danger",message:"Please provide a valid Email!"}),e.abrupt("return");case 9:if(""!==a.password){e.next=13;break}return y.current.focus(),b({type:"danger",message:"Please provide a password!"}),e.abrupt("return");case 13:if(!(a.password.length<8)){e.next=17;break}return y.current.focus(),b({type:"danger",message:"Please provide a longer password (8 characters min)!"}),e.abrupt("return");case 17:return e.next=19,fetch("/api/user/register",{method:"post",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify(a)}).then((function(e){return e.json()}));case 19:(n=e.sent).message?(b({type:"success",message:"Thank you successfully registered!"}),localStorage.email=n.email,setTimeout((function(){p(!0)}),5e3)):b({type:"danger",message:n.error});case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return c.a.createElement("div",null,o?c.a.createElement(i.a,{to:"/login"}):"",c.a.createElement("div",{className:f.type?"alert alert-".concat(f.type):"d-hide",role:"alert"},f.message),c.a.createElement("section",{class:"jumbotron text-center"},c.a.createElement("div",{class:"container"},c.a.createElement("h1",null,"User Registration"),c.a.createElement("p",{class:"lead text-muted"},"Register and go shopping!"))),c.a.createElement("div",{class:"container"},c.a.createElement("div",{class:"card"},c.a.createElement("div",{class:"card-header"},"Register"),c.a.createElement("div",{class:"card-body"},c.a.createElement("form",{role:"form"},c.a.createElement("input",{type:"hidden",id:"db_id",value:""}),c.a.createElement("div",{class:"form-group"},c.a.createElement("label",{for:"name"},"First Name"),c.a.createElement("input",{value:a.name,onChange:j,id:"name",type:"text",class:"form-control"})),c.a.createElement("div",{class:"form-group"},c.a.createElement("label",{for:"email"},"Email Address"),c.a.createElement("input",{value:a.email,onChange:j,ref:E,id:"email",type:"email",class:"form-control"})),c.a.createElement("div",{class:"form-group"},c.a.createElement("label",{for:"userPassword"},"Password"),c.a.createElement("input",{value:a.password,onChange:j,ref:y,id:"password",type:"password",class:"form-control"})),c.a.createElement("button",{onClick:function(e){return w.apply(this,arguments)},class:"btn btn-primary submit"},"Register"))))))};var F=function(){var e=Object(r.useState)({name:"",email:localStorage.email,password:"",rememberMe:!0}),t=Object(m.a)(e,2),a=t[0],n=t[1],l=Object(r.useState)(!1),s=Object(m.a)(l,2),o=s[0],p=s[1],d=Object(r.useState)({type:"",message:""}),g=Object(m.a)(d,2),f=g[0],b=g[1],E=Object(r.useRef)(),y=Object(r.useRef)();function w(e){var t=e.target,r=t.id,c=t.value;n(Object(u.a)({},a,Object(T.a)({},r,c)))}function O(){return(O=Object(h.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),""!==a.email){e.next=5;break}return E.focus(),b({type:"danger",message:"Please provide your Email!"}),e.abrupt("return");case 5:if(!(""===a.password||a.password.length<8)){e.next=9;break}return y.current.focus(),b({type:"danger",message:"Please provide your password!"}),e.abrupt("return");case 9:return e.next=11,j.post("/api/user/login",a);case 11:if((n=e.sent).session){e.next=16;break}return b({type:"danger",message:n.error}),localStorage.session="",e.abrupt("return");case 16:b({type:"success",message:"Loading, please wait..."}),localStorage.email=n.rememberMe?n.email:"",localStorage.session=n.session,setTimeout((function(){p(!0)}),3e3);case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return c.a.createElement("div",null,o?c.a.createElement(i.a,{to:"/productlist"}):"",c.a.createElement("div",{className:f.type?"alert alert-".concat(f.type):"d-hide",role:"alert"},f.message),c.a.createElement("section",{class:"jumbotron text-center"},c.a.createElement("div",{class:"container"},c.a.createElement("h1",null,"Login"),c.a.createElement("p",{class:"lead text-muted"},"Register and go shopping!"))),c.a.createElement("div",{class:"container"},c.a.createElement("div",{class:"card"},c.a.createElement("div",{class:"card-body"},c.a.createElement("form",{role:"form"},c.a.createElement("div",{class:"form-group"},c.a.createElement("label",{for:"userEmail"},"Email Address"),c.a.createElement("input",{value:a.email,onChange:w,ref:E,id:"email",type:"email",class:"form-control"})),c.a.createElement("div",{class:"form-group"},c.a.createElement("label",{for:"userPassword"},"Password"),c.a.createElement("input",{value:a.password,onChange:w,ref:y,id:"password",type:"password",class:"form-control"})),c.a.createElement("button",{onClick:function(e){return O.apply(this,arguments)},type:"button",class:"btn btn-primary submit"},"Login"),"\xa0",c.a.createElement("input",{type:"checkbox",checked:a.rememberMe,onChange:function(){n(Object(u.a)({},a,{rememberMe:!a.rememberMe}))}}),c.a.createElement("label",{class:"text-secondary",for:"rememberMe"},"Remember Me")," \xa0",c.a.createElement("a",{href:"/register"},"Need to Register?"))))))};var L=function(){var e=Object(r.useState)(!1),t=Object(m.a)(e,2),a=t[0],n=t[1],l=Object(r.useState)({type:"",message:""}),s=Object(m.a)(l,2),o=s[0],u=s[1];function p(){return(p=Object(h.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[logoutRequest] attempting to logout..."),e.next=3,j.post("/api/user/logout",{});case 3:if(t=e.sent,console.log("apiResult: ",t),!t.error){e.next=8;break}return u({type:"danger",message:t.error}),e.abrupt("return");case 8:u({type:"success",message:"Logged out..."}),localStorage.session="",setTimeout((function(){n(!0)}),3e3);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useEffect)((function(){!function(){p.apply(this,arguments)}()}),[]),c.a.createElement("div",null,a?c.a.createElement(i.a,{to:"/login"}):"",c.a.createElement("div",{className:o.type?"alert alert-".concat(o.type):"d-hide",role:"alert"},o.message),c.a.createElement("section",{class:"jumbotron text-center"},c.a.createElement("div",{class:"container"},c.a.createElement("p",{class:"lead text-muted"},"Please wait, logging out..."))))};var A=function(e){return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{id:"footer-padding"}),c.a.createElement("div",{id:"footer"},"(c) 2020 The Everest Team"))};var _=function(){return c.a.createElement(o.a,null,c.a.createElement(g,null," ",c.a.createElement("div",{className:"App"},c.a.createElement(b,null),c.a.createElement("div",{class:"container"},c.a.createElement(i.b,{exact:!0,path:["/","/productlist"],component:w}),c.a.createElement(i.b,{path:"/productinfo/:id",component:S}),c.a.createElement(i.b,{exact:!0,path:"/productadd",component:R}),c.a.createElement(i.b,{exact:!0,path:"/cart",component:P}),c.a.createElement(i.b,{exact:!0,path:"/register",component:M}),c.a.createElement(i.b,{exact:!0,path:"/login",component:F}),c.a.createElement(i.b,{exact:!0,path:"/logout",component:L}),c.a.createElement(i.b,{exact:!0,path:"/settings",component:N})),c.a.createElement(A,null))))};s.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(_,null)),document.getElementById("root"))}},[[22,1,2]]]);
//# sourceMappingURL=main.06319322.chunk.js.map