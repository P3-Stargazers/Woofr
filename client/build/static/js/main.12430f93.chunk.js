(this.webpackJsonpeverest=this.webpackJsonpeverest||[]).push([[0],{22:function(e,t,a){e.exports=a(34)},27:function(e,t,a){},34:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(19),s=a.n(c),o=(a(27),a(2)),l=a(10),i=a(1),u=a(7),m={messageType:"",message:"",serverStatus:"",loggedIn:!1,cart:[]},d=r.a.createContext(),g={do:"",time:0};function p(e,t){if(console.log("[dispatcher] called with ".concat(t.do)),t.do==g.do&&Date.now()-g.time<1e3)return console.log(".. dispatch times too close for ".concat(t.do,"; ignoring it.")),e;g={do:t.do,time:Date.now()};var a=Object(u.a)({},e);switch(t.do){case"addToCart":var n=a.cart.findIndex((function(e){return e.id===t.id}));return n>-1?(console.log("[dispatcher:".concat(t.do,"] cart.num(").concat(a.cart[n].num,") += (").concat(t.num,")")),a.cart[n].num+=t.num):a.cart.push(Object(u.a)({},t)),console.log("[GlobalStore:addToCart] id(".concat(t.id,") cartItemIdx(").concat(n,")"),a),a;case"setMessage":return a.messageType=t.type,a.message=t.message,console.log("[GlobalStore:setMessage] set our message: ".concat(t.message)),a;case"clearMessage":return a.messageType="",a.message="",a;case"loginState":return a.loggedIn=t.loggedIn,!1===t.loggedIn&&(a=Object(u.a)({},m)),a;case"setUserData":return a=Object(u.a)({},a,{},t.data);default:console.log("[ERROR] Sorry, unknown do-action: ".concat(t.do))}}function f(e){var t=Object(n.useReducer)(p,m),a=Object(i.a)(t,2),c=a[0],s=a[1];return r.a.createElement(d.Provider,Object.assign({value:[c,s]},e))}function b(){return Object(n.useContext)(d)}var v=a(4),E=a.n(v),h=a(6);var w,y,j={get:function(e){return fetch(e,{headers:{Session:localStorage.session?localStorage.session:""}}).then((function(e){return e.json()}))},post:function(e,t){return fetch(e,{method:"post",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json",Session:localStorage.session?localStorage.session:""},body:JSON.stringify(t)}).then((function(e){return e.json()}))}};var x=function(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),a=t[0],c=t[1],s=Object(n.useState)(!1),u=Object(i.a)(s,2),m=u[0],d=u[1],g=b(),p=Object(i.a)(g,2),f=p[0],v=p[1],x=Object(l.f)();function O(){return k.apply(this,arguments)}function k(){return(k=Object(h.a)(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.get("/server-status");case 3:"running"===(t=e.sent).status?"running"!==f.serverStatus&&v({do:"clearMessage"}):(v({do:"setMessage",type:"danger",message:t.error}),console.log("[App] Crap server is not running, show an error...")),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),v({do:"setMessage",type:"danger",message:"Server down..."});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}Object(n.useEffect)((function(){!function(){var e=localStorage.session&&36===localStorage.session.length,t="/login"===x.pathname||"/register"===x.pathname;console.log("[Navbar] isSessionExisting(".concat(e,") isUrlNotRequiringLogin(").concat(t,"): ").concat(!e&&!t)),d(!e&&!t)}(),setInterval(O,15e3),O()}),[]),a&&(clearTimeout(w),w=setTimeout((function(){c(!1)}),2e3)),y!==x.pathname&&(console.log("**** > location changed, hiding menu"),clearTimeout(w),w=setTimeout((function(){c(!1)}),100),y=x.pathname);var S=f&&f.cart?f.cart.reduce((function(e,t){return e+t.num}),0):0;return r.a.createElement(r.a.Fragment,null,m?r.a.createElement(l.a,{to:"/login"}):"",r.a.createElement("nav",{class:"navbar navbar-expand-lg navbar-light bg-light"},r.a.createElement(o.b,{to:"/",className:"navbar-brand"},r.a.createElement("img",{src:"https://upload.wikimedia.org/wikipedia/commons/7/79/Mountain_icon_%28Noun_Project%29.svg",alt:"",style:{width:"64px",height:"64px"}})),r.a.createElement("button",{onClick:function(){return c(!a)},class:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{class:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse "+(a?"show":""),id:"navbarSupportedContent"},r.a.createElement("ul",{class:"navbar-nav mr-auto"},r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.b,{to:"/productlist",className:"/productlist"===x.pathname?"nav-link active":"nav-link"},"Product List")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.b,{to:"/productadd",className:"/productadd"===x.pathname?"nav-link active":"nav-link"},"Product Add")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.b,{to:"/settings",className:"/settings"===x.pathname?"nav-link active":"nav-link"},"Settings")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.b,{to:"/cart",className:"/cart"===x.pathname?"nav-link active":"nav-link"},S?r.a.createElement("span",{class:"badge badge-pill badge-success"},r.a.createElement("i",{class:"fas fa-shopping-cart"})," ",S):"")),localStorage.session?r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.b,{to:"/logout",className:"nav-link"},"Logout")):r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.b,{to:"/login",className:"nav-link"},"Login"))))),r.a.createElement("div",{class:"container"},f.name?r.a.createElement("div",{class:"d-block"},f&&f.thumbnail?r.a.createElement("img",{src:f.thumbnail,id:"navThumbnail"}):""," Welcome ",f.name):"",r.a.createElement("div",{className:f.messageType?"alert alert-".concat(f.messageType):"d-hide",role:"alert"},f.message)))};var O=function(e){return r.a.createElement("div",{key:e.heading,className:"card mx-auto col-4"},r.a.createElement(o.b,{to:"/productinfo/"+e.id},r.a.createElement("img",{className:"card-img-top",src:e.image,alt:e.description,title:e.description}),r.a.createElement("div",{className:"card-body"},r.a.createElement("h4",{className:"card-title"},e.heading),r.a.createElement("p",{className:"card-text"},e.price))))};var k=function(e){var t=b(),a=Object(i.a)(t,2),c=(a[0],a[1]),s=Object(n.useState)([]),o=Object(i.a)(s,2),l=o[0],u=o[1];function m(){return(m=Object(h.a)(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.get("/api/product/list");case 2:if(!(t=e.sent).error){e.next=6;break}return c({do:"setMessage",type:"danger",message:t.error}),e.abrupt("return");case 6:u(t);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){!function(){m.apply(this,arguments)}()}),[]),r.a.createElement("div",{class:"row"},l.map((function(e){return r.a.createElement(O,e)})))};var S=function(e){for(var t="",a=1;a<=5;a++)t+=e.rating>=a?'<i class="fas fa-star text-warning"></i>':'<i class="far fa-star"></i>';return r.a.createElement("div",{dangerouslySetInnerHTML:{__html:t}})};var N=function(e){return r.a.createElement("form",null,r.a.createElement("div",{class:"form-group"},r.a.createElement("label",{for:"formName"},"Email"),r.a.createElement("input",{type:"email",class:"form-control",id:"formName",placeholder:"name@example.com"})),r.a.createElement("div",{class:"form-group"},r.a.createElement("label",{for:"formRating"},"Rating..."),r.a.createElement("select",{class:"form-control",id:"formRating"},r.a.createElement("option",null,"1"),r.a.createElement("option",null,"2"),r.a.createElement("option",null,"3"),r.a.createElement("option",null,"4"),r.a.createElement("option",null,"5"))),r.a.createElement("div",{class:"form-group"},r.a.createElement("label",{for:"formReview"},"Your Review"),r.a.createElement("textarea",{class:"form-control",id:"formReview",rows:"3"})),r.a.createElement("button",{class:"btn btn-lg btn-primary",onClick:e.saveForm},"Save Review"))};var M=function(e){var t=Object(n.useState)(!1),a=Object(i.a)(t,2),c=a[0],s=a[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement("hr",null),c?r.a.createElement(N,{saveForm:function(e){e.preventDefault(),s(!1)}}):r.a.createElement("div",{class:"d-flex justify-content-end"},r.a.createElement("button",{class:"btn btn-lg btn-secondary",onClick:function(){s(!0)}},r.a.createElement("i",{class:"fas fa-grin-stars"})," Review")),r.a.createElement("ul",{class:"list-group"},e.reviews?e.reviews.map((function(e){return r.a.createElement("li",{class:"list-group-item"},r.a.createElement("div",{class:"row"},r.a.createElement("div",{class:"col-8"},r.a.createElement("b",null,e.name)),r.a.createElement("div",{class:"col-4 pull-right"},r.a.createElement(S,{rating:e.rating}))),e.review)})):"<li>No reviews yet</li>"))};var C=function(){console.log("[ProductInfoPage] function called for re-render check.");var e=Object(l.g)().id,t=Object(n.useState)([]),a=Object(i.a)(t,2),c=a[0],s=a[1],o=b(),m=Object(i.a)(o,2)[1];function d(){return(d=Object(h.a)(E.a.mark((function e(t){var a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.get("/api/product/".concat(t));case 2:if(!(a=e.sent).error){e.next=7;break}return console.log("/api/product/".concat(t," error: ").concat(a.error)),m({do:"setMessage",type:"danger",message:a.error}),e.abrupt("return");case 7:s(a);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){!function(e){d.apply(this,arguments)}(e)}),[]),r.a.createElement("div",{class:"container"},r.a.createElement("div",{class:"row"},r.a.createElement("div",{class:"col-4"},r.a.createElement("img",{src:c.image,class:"img-thumbnail"})),r.a.createElement("div",{class:"col-8"},r.a.createElement("h1",null,c.heading),r.a.createElement("h2",null,c.price),r.a.createElement("h3",null,r.a.createElement(S,{rating:c.rating})),r.a.createElement("button",{onClick:function(){console.log("[addToCart] called..."),m(Object(u.a)({do:"addToCart",id:e,num:1},c))},class:"btn btn-lg btn-primary"},r.a.createElement("i",{class:"fas fa-cart-plus"}))),c.description),r.a.createElement(M,{id:c.id,reviews:c.reviews}))};var R=function(e){return r.a.createElement(r.a.Fragment,null,"[SettingsPage]")};var T=function(e){return r.a.createElement("div",null,"[Product Add]")};var P=function(e){return r.a.createElement("li",{class:"list-group-item d-flex justify-content-between align-items-center"},r.a.createElement(o.b,{to:"/productinfo/"+e.id},r.a.createElement("img",{class:"img-thumbnail",src:e.image,style:{width:"64px",height:"64px"}}),e.heading),r.a.createElement("span",{class:"badge badge-secondary badge-pill pull-right"},e.num))};var I=function(e){var t=b(),a=Object(i.a)(t,2),n=a[0];return a[1],r.a.createElement("ul",{key:e.heading,class:"list-group"},n.cart.map((function(e){return r.a.createElement(P,e)})))},A=a(12);var L,D=function(){var e=b(),t=Object(i.a)(e,2),a=(t[0],t[1]),c=Object(n.useState)({name:"",email:"",password:""}),s=Object(i.a)(c,2),o=s[0],m=s[1],d=Object(n.useState)(!1),g=Object(i.a)(d,2),p=g[0],f=g[1],v=Object(n.useRef)(),w=Object(n.useRef)();function y(e){var t=e.target,a=t.id,n=t.value;m(Object(u.a)({},o,Object(A.a)({},a,n)))}function x(){return(x=Object(h.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),""!==o.email.trim()&&/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(o.email)){e.next=5;break}return v.current.focus(),a({do:"setMessage",type:"danger",message:"Please provide a valid email"}),e.abrupt("return");case 5:if(""!==o.password.trim()){e.next=9;break}return w.current.focus(),a({do:"setMessage",type:"danger",message:"Please provide a password"}),e.abrupt("return");case 9:if(!(o.password.trim().length<8)){e.next=13;break}return w.current.focus(),a({do:"setMessage",type:"danger",message:"Please provide a longer password (8 characters min)!"}),e.abrupt("return");case 13:return e.next=15,j.post("/api/user/register",o);case 15:if(!(n=e.sent).error){e.next=19;break}return a({do:"setMessage",type:"danger",message:n.error}),e.abrupt("return");case 19:localStorage.email=n.rememberMe?n.email:"",a({do:"setMessage",type:"success",message:"Thank you successfully registered"}),setTimeout((function(){f(!0)}),5e3);case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return r.a.createElement("div",null,p?r.a.createElement(l.a,{to:"/login"}):"",r.a.createElement("div",{class:"container"},r.a.createElement("h1",null,"User Registration"),r.a.createElement("div",{class:"card"},r.a.createElement("div",{class:"card-header"},"Register"),r.a.createElement("div",{class:"card-body"},r.a.createElement("form",{role:"form"},r.a.createElement("input",{type:"hidden",id:"db_id",value:""}),r.a.createElement("div",{class:"form-group"},r.a.createElement("label",{for:"name"},"First Name"),r.a.createElement("input",{value:o.name,onChange:y,id:"name",type:"text",class:"form-control"})),r.a.createElement("div",{class:"form-group"},r.a.createElement("label",{for:"email"},"Email Address"),r.a.createElement("input",{value:o.email,onChange:y,ref:v,id:"email",type:"email",class:"form-control"})),r.a.createElement("div",{class:"form-group"},r.a.createElement("label",{for:"userPassword"},"Password"),r.a.createElement("input",{value:o.password,onChange:y,ref:w,id:"password",type:"password",class:"form-control"})),r.a.createElement("button",{onClick:function(e){return x.apply(this,arguments)},class:"btn btn-primary submit"},"Register"),"\xa0 \xa0 ",r.a.createElement("a",{href:"/login",class:"font-weight-light text-muted"},"Already Registered?"))))))},F=window.location.protocol+"//"+window.location.host.replace("localhost:3000","localhost:8080"),q=!1;var _=function(e){function t(e){if(!q){var t=window.innerWidth/2-300,a=window.innerHeight/2-300,n="".concat(F,"/oauth/").concat(e);console.log("[openOAuth] opening url: ".concat(n)),L=window.open(n,"","toolbar=no, location=no, directories=no, status=no, menubar=no, \n          scrollbars=no, resizable=no, copyhistory=no, width=".concat(600,", \n          height=").concat(600,", top=").concat(a,", left=").concat(t)),q=!0,function(){var e=setInterval((function(){L&&!L.closed&&void 0!==L.closed||(clearInterval(e),q=!1)}),1e3)}()}}Object(n.useEffect)((function(){window.addEventListener("message",(function(t){if(t&&t.data&&"string"===typeof t.data&&"{"===t.data.substr(0,1)&&"}"===t.data.substr(-1,1)){var a=JSON.parse(t.data);console.log("<< from popup window, received:",a),L&&L.close(),e.loginComplete&&e.loginComplete(a)}}),!1)}),[]);var a={facebook:"fa-facebook-square",twitter:"fa-twitter-square",google:"fa-google-plus-square",github:"fa-github-square",linkedin:"fa-linkedin"};return r.a.createElement("div",{class:"card"},r.a.createElement("div",{class:"card-body d-flex justify-content-center"},e.providers.map((function(e){return r.a.createElement("button",{onClick:function(){return t(e)},class:"btn btn-outline-primary",style:{marginRight:"10px"}},r.a.createElement("i",{className:"fab ".concat(a[e]," fa-3x")}))}))))};var J=function(){var e=Object(n.useState)({name:"",email:localStorage.email,password:"",rememberMe:!0}),t=Object(i.a)(e,2),a=t[0],c=t[1],s=b(),o=Object(i.a)(s,2),m=o[0],d=o[1],g=Object(n.useRef)(),p=Object(n.useRef)();function f(e){var t=e.target,n=t.id,r=t.value;c(Object(u.a)({},a,Object(A.a)({},n,r)))}function v(e){d({do:"setMessage",type:"success",message:e.message}),delete e.message,localStorage.session=e.session,d({do:"setUserData",data:e}),setTimeout((function(){d({do:"clearMessage"}),d({do:"loginState",loggedIn:!0})}),3e3)}function w(){return(w=Object(h.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),""!==a.email){e.next=5;break}return g.focus(),d({do:"setMessage",type:"danger",message:"Please enter your email!"}),e.abrupt("return");case 5:if(!(""===a.password||a.password.length<8)){e.next=9;break}return p.current.focus(),d({do:"setMessage",type:"danger",message:"Please enter your password!"}),e.abrupt("return");case 9:return e.next=11,j.post("/api/user/login",a);case 11:if(!(n=e.sent).error){e.next=16;break}return d({do:"setMessage",type:"danger",message:n.error}),localStorage.session="",e.abrupt("return");case 16:v(n);case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return r.a.createElement("div",null,m.loggedIn?r.a.createElement(l.a,{to:"/productlist"}):"",r.a.createElement("hr",null),r.a.createElement("h1",null,"Login"),r.a.createElement("div",{class:"container"},r.a.createElement(_,{providers:["twitter","facebook","github","google","linkedin"],loginComplete:v}),r.a.createElement("div",{class:"card"},r.a.createElement("div",{class:"card-body"},r.a.createElement("form",{role:"form"},r.a.createElement("div",{class:"form-group"},r.a.createElement("label",{for:"userEmail"},"Email Address"),r.a.createElement("input",{value:a.email,onChange:f,ref:g,id:"email",type:"email",class:"form-control"})),r.a.createElement("div",{class:"form-group"},r.a.createElement("label",{for:"userPassword"},"Password"),r.a.createElement("input",{value:a.password,onChange:f,ref:p,id:"password",type:"password",class:"form-control"})),r.a.createElement("button",{onClick:function(e){return w.apply(this,arguments)},type:"button",class:"btn btn-primary submit"},"Login"),"\xa0",r.a.createElement("input",{type:"checkbox",checked:a.rememberMe,onChange:function(){c(Object(u.a)({},a,{rememberMe:!a.rememberMe}))}}),r.a.createElement("label",{class:"text-secondary",for:"rememberMe"},"Remember Me")," \xa0",r.a.createElement("a",{href:"/register"},"Need to Register?"))))))};var U=function(){var e=b(),t=Object(i.a)(e,2),a=t[0],c=t[1];function s(){return(s=Object(h.a)(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[logoutRequest] attempting to logout..."),e.next=3,j.post("/api/user/logout",{});case 3:if(t=e.sent,console.log("apiResult: ",t),!t.error){e.next=8;break}return c({do:"setMessage",type:"danger",message:t.error}),e.abrupt("return");case 8:c({do:"setMessage",type:"success",message:"Logged out..."}),localStorage.session="",setTimeout((function(){c({do:"loginState",loggedIn:!1})}),3e3);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){!function(){s.apply(this,arguments)}()}),[]),r.a.createElement("div",null,a.loggedIn?"":r.a.createElement(l.a,{to:"/login"}),"\\            ",r.a.createElement("section",{class:"jumbotron text-center"},r.a.createElement("div",{class:"container"},r.a.createElement("p",{class:"lead text-muted"},"Please wait, logging out..."))))};var G=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"footer-padding"}),r.a.createElement("div",{id:"footer"},"(c) 2020 The Everest Team"))};var H=function(){return r.a.createElement(o.a,null,r.a.createElement(f,null," ",r.a.createElement("div",{className:"App"},r.a.createElement(x,null),r.a.createElement("div",{class:"container"},r.a.createElement(l.b,{exact:!0,path:["/","/productlist"],component:k}),r.a.createElement(l.b,{path:"/productinfo/:id",component:C}),r.a.createElement(l.b,{exact:!0,path:"/productadd",component:T}),r.a.createElement(l.b,{exact:!0,path:"/cart",component:I}),r.a.createElement(l.b,{exact:!0,path:"/register",component:D}),r.a.createElement(l.b,{exact:!0,path:"/login",component:J}),r.a.createElement(l.b,{exact:!0,path:"/logout",component:U}),r.a.createElement(l.b,{exact:!0,path:"/settings",component:R})),r.a.createElement(G,null))))};s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(H,null)),document.getElementById("root"))}},[[22,1,2]]]);
//# sourceMappingURL=main.12430f93.chunk.js.map