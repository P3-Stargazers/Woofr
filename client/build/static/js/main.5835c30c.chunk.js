(this.webpackJsonpeverest=this.webpackJsonpeverest||[]).push([[0],{22:function(e,t,a){e.exports=a(34)},27:function(e,t,a){},34:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(19),s=a.n(c),o=(a(27),a(2)),l=a(10),i=a(1),u=a(8),m=r.a.createContext();function d(e,t){var a=Object(u.a)({},e);switch(t.do){case"addToCart":var n=a.cart.findIndex((function(e){return e.id===t.id}));return n>-1?(console.log("[dispatcher:".concat(t.type,"] cart.num(").concat(a.cart[n].num,") += (").concat(t.num,")")),a.cart[n].num+=t.num):a.cart.push(Object(u.a)({},t)),console.log("[GlobalStore:addToCart] id(".concat(t.id,") cartItemIdx(").concat(n,")"),a),a;case"setMessage":return a.messageType=t.type,a.message=t.message,console.log("[GlobalStore:setMessage] set our message: ".concat(t.message)),a;case"clearMessage":return a.messageType="",a.message="",a;case"loginState":return a.loggedIn=t.loggedIn,a;case"setUserData":return a=Object(u.a)({},a,{},t.data);default:console.log("[ERROR] Sorry, unknown do-action: ".concat(t.do))}}function p(e){var t=Object(n.useReducer)(d,{messageType:"",message:"",serverStatus:"",loggedIn:!1,cart:[]}),a=Object(i.a)(t,2),c=a[0],s=a[1];return r.a.createElement(m.Provider,Object.assign({value:[c,s]},e))}function g(){return Object(n.useContext)(m)}var f=a(4),b=a.n(f),v=a(6);var E,h,w={get:function(e){return fetch(e,{headers:{Session:localStorage.session?localStorage.session:""}}).then((function(e){return e.json()}))},post:function(e,t){return fetch(e,{method:"post",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json",Session:localStorage.session?localStorage.session:""},body:JSON.stringify(t)}).then((function(e){return e.json()}))}};var y=function(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),a=t[0],c=t[1],s=Object(n.useState)(!1),u=Object(i.a)(s,2),m=u[0],d=u[1],p=g(),f=Object(i.a)(p,2),y=f[0],j=f[1],x=Object(l.f)();function O(){return k.apply(this,arguments)}function k(){return(k=Object(v.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.get("/server-status");case 3:"running"===(t=e.sent).status?"running"!==y.serverStatus&&j({do:"clearMessage"}):(j({do:"setMessage",type:"danger",message:t.error}),console.log("[App] Crap server is not running, show an error...")),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),j({do:"setMessage",type:"danger",message:"Server down..."});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}Object(n.useEffect)((function(){!function(){var e=localStorage.session&&36===localStorage.session.length,t="/login"===x.pathname||"/register"===x.pathname;console.log("[Navbar] isSessionExisting(".concat(e,") isUrlNotRequiringLogin(").concat(t,"): ").concat(!e&&!t)),d(!e&&!t)}(),setInterval(O,15e3),O()}),[]),a&&(clearTimeout(E),E=setTimeout((function(){c(!1)}),2e3)),h!==x.pathname&&(console.log("**** > location changed, hiding menu"),clearTimeout(E),E=setTimeout((function(){c(!1)}),100),h=x.pathname);var S=y&&y.cart?y.cart.reduce((function(e,t){return e+t.num}),0):0;return r.a.createElement(r.a.Fragment,null,m?r.a.createElement(l.a,{to:"/login"}):"",r.a.createElement("nav",{class:"navbar navbar-expand-lg navbar-light bg-light"},r.a.createElement(o.b,{to:"/",className:"navbar-brand"},r.a.createElement("img",{src:"https://upload.wikimedia.org/wikipedia/commons/7/79/Mountain_icon_%28Noun_Project%29.svg",alt:"",style:{width:"64px",height:"64px"}})),r.a.createElement("button",{onClick:function(){return c(!a)},class:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{class:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse "+(a?"show":""),id:"navbarSupportedContent"},r.a.createElement("ul",{class:"navbar-nav mr-auto"},r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.b,{to:"/productlist",className:"/productlist"===x.pathname?"nav-link active":"nav-link"},"Product List")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.b,{to:"/productadd",className:"/productadd"===x.pathname?"nav-link active":"nav-link"},"Product Add")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.b,{to:"/settings",className:"/settings"===x.pathname?"nav-link active":"nav-link"},"Settings")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.b,{to:"/cart",className:"/cart"===x.pathname?"nav-link active":"nav-link"},S?r.a.createElement("span",{class:"badge badge-pill badge-success"},r.a.createElement("i",{class:"fas fa-shopping-cart"})," ",S):"")),localStorage.session?r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.b,{to:"/logout",className:"nav-link"},"Logout")):r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.b,{to:"/login",className:"nav-link"},"Login"))))),r.a.createElement("div",{class:"container"},r.a.createElement("div",{class:"d-block"},y.thumbnail?r.a.createElement("img",{src:y.thumbnail,id:"navThumbnail"}):""," Welcome ",y.name),r.a.createElement("div",{className:y.messageType?"alert alert-".concat(y.messageType):"d-hide",role:"alert"},y.message)))};var j=function(e){return r.a.createElement("div",{key:e.heading,className:"card mx-auto col-4"},r.a.createElement(o.b,{to:"/productinfo/"+e.id},r.a.createElement("img",{className:"card-img-top",src:e.image,alt:e.description,title:e.description}),r.a.createElement("div",{className:"card-body"},r.a.createElement("h4",{className:"card-title"},e.heading),r.a.createElement("p",{className:"card-text"},e.price))))};var x=function(e){var t=g(),a=Object(i.a)(t,2),c=(a[0],a[1]),s=Object(n.useState)([]),o=Object(i.a)(s,2),l=o[0],u=o[1];function m(){return(m=Object(v.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.get("/api/product/list");case 2:if(!(t=e.sent).error){e.next=6;break}return c({do:"setMessage",type:"danger",message:t.error}),e.abrupt("return");case 6:u(t);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){!function(){m.apply(this,arguments)}()}),[]),r.a.createElement("div",{class:"row"},l.map((function(e){return r.a.createElement(j,e)})))};var O=function(e){for(var t="",a=1;a<=5;a++)t+=e.rating>=a?'<i class="fas fa-star text-warning"></i>':'<i class="far fa-star"></i>';return r.a.createElement("div",{dangerouslySetInnerHTML:{__html:t}})};var k=function(e){return r.a.createElement("form",null,r.a.createElement("div",{class:"form-group"},r.a.createElement("label",{for:"formName"},"Email"),r.a.createElement("input",{type:"email",class:"form-control",id:"formName",placeholder:"name@example.com"})),r.a.createElement("div",{class:"form-group"},r.a.createElement("label",{for:"formRating"},"Rating..."),r.a.createElement("select",{class:"form-control",id:"formRating"},r.a.createElement("option",null,"1"),r.a.createElement("option",null,"2"),r.a.createElement("option",null,"3"),r.a.createElement("option",null,"4"),r.a.createElement("option",null,"5"))),r.a.createElement("div",{class:"form-group"},r.a.createElement("label",{for:"formReview"},"Your Review"),r.a.createElement("textarea",{class:"form-control",id:"formReview",rows:"3"})),r.a.createElement("button",{class:"btn btn-lg btn-primary",onClick:e.saveForm},"Save Review"))};var S=function(e){var t=Object(n.useState)(!1),a=Object(i.a)(t,2),c=a[0],s=a[1];return console.log("[ProductReviews] showForm=",c),r.a.createElement(r.a.Fragment,null,r.a.createElement("hr",null),c?r.a.createElement(k,{saveForm:function(e){e.preventDefault(),s(!1)}}):r.a.createElement("div",{class:"d-flex justify-content-end"},r.a.createElement("button",{class:"btn btn-lg btn-secondary",onClick:function(){s(!0)}},r.a.createElement("i",{class:"fas fa-grin-stars"})," Review")),r.a.createElement("ul",{class:"list-group"},e.reviews?e.reviews.map((function(e){return r.a.createElement("li",{class:"list-group-item"},r.a.createElement("div",{class:"row"},r.a.createElement("div",{class:"col-8"},r.a.createElement("b",null,e.name)),r.a.createElement("div",{class:"col-4 pull-right"},r.a.createElement(O,{rating:e.rating}))),e.review)})):"<li>No reviews yet</li>"))};var N=function(e){var t=Object(l.g)().id,a=Object(n.useState)([]),c=Object(i.a)(a,2),s=c[0],o=c[1],m=g(),d=Object(i.a)(m,2),p=(d[0],d[1]);function f(){return(f=Object(v.a)(b.a.mark((function e(t){var a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.get("/api/product/".concat(t));case 2:if(!(a=e.sent).error){e.next=6;break}return p({do:"setMessage",type:"danger",message:a.error}),e.abrupt("return");case 6:o(a);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){!function(e){f.apply(this,arguments)}(t)}),[]),r.a.createElement("div",{class:"container"},r.a.createElement("div",{class:"row"},r.a.createElement("div",{class:"col-4"},r.a.createElement("img",{src:s.image,class:"img-thumbnail"})),r.a.createElement("div",{class:"col-8"},r.a.createElement("h1",null,s.heading),r.a.createElement("h2",null,s.price),r.a.createElement("h3",null,r.a.createElement(O,{rating:s.rating})),r.a.createElement("button",{onClick:function(){p(Object(u.a)({type:"addToCart",id:t,num:1},s))},class:"btn btn-lg btn-primary"},r.a.createElement("i",{class:"fas fa-cart-plus"}))),s.description),r.a.createElement(S,{id:s.id,reviews:s.reviews}))};var M=function(e){return r.a.createElement(r.a.Fragment,null,"[SettingsPage]")};var C=function(e){return r.a.createElement("div",null,"[Product Add]")};var R=function(e){return r.a.createElement("li",{class:"list-group-item d-flex justify-content-between align-items-center"},r.a.createElement(o.b,{to:"/productinfo/"+e.id},r.a.createElement("img",{class:"img-thumbnail",src:e.image,style:{width:"64px",height:"64px"}}),e.heading),r.a.createElement("span",{class:"badge badge-secondary badge-pill pull-right"},e.num))};var T=function(e){var t=g(),a=Object(i.a)(t,2),n=a[0];return a[1],r.a.createElement("ul",{key:e.heading,class:"list-group"},n.cart.map((function(e){return r.a.createElement(R,e)})))},P=a(12);var I,L=function(){var e=g(),t=Object(i.a)(e,2),a=(t[0],t[1]),c=Object(n.useState)({name:"",email:"",password:""}),s=Object(i.a)(c,2),o=s[0],m=s[1],d=Object(n.useState)(!1),p=Object(i.a)(d,2),f=p[0],E=p[1],h=Object(n.useRef)(),y=Object(n.useRef)();function j(e){var t=e.target,a=t.id,n=t.value;m(Object(u.a)({},o,Object(P.a)({},a,n)))}function x(){return(x=Object(v.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),""!==o.email.trim()&&/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(o.email)){e.next=5;break}return h.current.focus(),a({do:"setMessage",type:"danger",message:"Please provide a valid email"}),e.abrupt("return");case 5:if(""!==o.password.trim()){e.next=9;break}return y.current.focus(),a({do:"setMessage",type:"danger",message:"Please provide a password"}),e.abrupt("return");case 9:if(!(o.password.trim().length<8)){e.next=13;break}return y.current.focus(),a({do:"setMessage",type:"danger",message:"Please provide a longer password (8 characters min)!"}),e.abrupt("return");case 13:return e.next=15,w.post("/api/user/register",o);case 15:if(!(n=e.sent).error){e.next=19;break}return a({do:"setMessage",type:"danger",message:n.error}),e.abrupt("return");case 19:localStorage.email=n.rememberMe?n.email:"",a({do:"setMessage",type:"success",message:"Thank you successfully registered"}),setTimeout((function(){E(!0)}),5e3);case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return r.a.createElement("div",null,f?r.a.createElement(l.a,{to:"/login"}):"",r.a.createElement("div",{class:"container"},r.a.createElement("h1",null,"User Registration"),r.a.createElement("div",{class:"card"},r.a.createElement("div",{class:"card-header"},"Register"),r.a.createElement("div",{class:"card-body"},r.a.createElement("form",{role:"form"},r.a.createElement("input",{type:"hidden",id:"db_id",value:""}),r.a.createElement("div",{class:"form-group"},r.a.createElement("label",{for:"name"},"First Name"),r.a.createElement("input",{value:o.name,onChange:j,id:"name",type:"text",class:"form-control"})),r.a.createElement("div",{class:"form-group"},r.a.createElement("label",{for:"email"},"Email Address"),r.a.createElement("input",{value:o.email,onChange:j,ref:h,id:"email",type:"email",class:"form-control"})),r.a.createElement("div",{class:"form-group"},r.a.createElement("label",{for:"userPassword"},"Password"),r.a.createElement("input",{value:o.password,onChange:j,ref:y,id:"password",type:"password",class:"form-control"})),r.a.createElement("button",{onClick:function(e){return x.apply(this,arguments)},class:"btn btn-primary submit"},"Register"))))))},A=window.location.protocol+"//"+window.location.host.replace("localhost:3000","localhost:8080"),F=!1;var q=function(e){function t(e){if(!F){var t=window.innerWidth/2-300,a=window.innerHeight/2-300,n="".concat(A,"/oauth/").concat(e);console.log("[openOAuth] opening url: ".concat(n)),I=window.open(n,"","toolbar=no, location=no, directories=no, status=no, menubar=no, \n          scrollbars=no, resizable=no, copyhistory=no, width=".concat(600,", \n          height=").concat(600,", top=").concat(a,", left=").concat(t)),F=!0,function(){var e=setInterval((function(){I&&!I.closed&&void 0!==I.closed||(clearInterval(e),F=!1)}),1e3)}()}}Object(n.useEffect)((function(){window.addEventListener("message",(function(t){if(t&&t.data&&"string"===typeof t.data&&"{"===t.data.substr(0,1)&&"}"===t.data.substr(-1,1)){var a=JSON.parse(t.data);console.log("<< from popup window, received:",a),I&&I.close(),e.loginComplete&&e.loginComplete(a)}}),!1)}),[]);var a={facebook:"fa-facebook-square",twitter:"fa-twitter-square",google:"fa-google-plus-square",github:"fa-github-square",linkedin:"fa-linkedin"};return r.a.createElement("div",{class:"card"},r.a.createElement("div",{class:"card-body d-flex justify-content-center"},e.providers.map((function(e){return r.a.createElement("button",{onClick:function(){return t(e)},class:"btn btn-outline-primary",style:{marginRight:"10px"}},r.a.createElement("i",{className:"fab ".concat(a[e]," fa-3x")}))}))))};var _=function(){var e=Object(n.useState)({name:"",email:localStorage.email,password:"",rememberMe:!0}),t=Object(i.a)(e,2),a=t[0],c=t[1],s=g(),o=Object(i.a)(s,2),m=o[0],d=o[1],p=Object(n.useRef)(),f=Object(n.useRef)();function E(e){var t=e.target,n=t.id,r=t.value;c(Object(u.a)({},a,Object(P.a)({},n,r)))}function h(e){d({do:"setMessage",type:"success",message:e.message}),delete e.message,localStorage.session=e.session,d({do:"setUserData",data:e}),setTimeout((function(){d({do:"clearMessage"}),d({do:"loginState",loggedIn:!0})}),3e3)}function y(){return(y=Object(v.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),""!==a.email){e.next=5;break}return p.focus(),d({do:"setMessage",type:"danger",message:"Please enter your email!"}),e.abrupt("return");case 5:if(!(""===a.password||a.password.length<8)){e.next=9;break}return f.current.focus(),d({do:"setMessage",type:"danger",message:"Please enter your password!"}),e.abrupt("return");case 9:return e.next=11,w.post("/api/user/login",a);case 11:if(!(n=e.sent).error){e.next=16;break}return d({do:"setMessage",type:"danger",message:n.error}),localStorage.session="",e.abrupt("return");case 16:h(n);case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return r.a.createElement("div",null,m.loggedIn?r.a.createElement(l.a,{to:"/productlist"}):"",r.a.createElement("hr",null),r.a.createElement("h1",null,"Login"),r.a.createElement("div",{class:"container"},r.a.createElement(q,{providers:["twitter","facebook","github","google","linkedin"],loginComplete:h}),r.a.createElement("div",{class:"card"},r.a.createElement("div",{class:"card-body"},r.a.createElement("form",{role:"form"},r.a.createElement("div",{class:"form-group"},r.a.createElement("label",{for:"userEmail"},"Email Address"),r.a.createElement("input",{value:a.email,onChange:E,ref:p,id:"email",type:"email",class:"form-control"})),r.a.createElement("div",{class:"form-group"},r.a.createElement("label",{for:"userPassword"},"Password"),r.a.createElement("input",{value:a.password,onChange:E,ref:f,id:"password",type:"password",class:"form-control"})),r.a.createElement("button",{onClick:function(e){return y.apply(this,arguments)},type:"button",class:"btn btn-primary submit"},"Login"),"\xa0",r.a.createElement("input",{type:"checkbox",checked:a.rememberMe,onChange:function(){c(Object(u.a)({},a,{rememberMe:!a.rememberMe}))}}),r.a.createElement("label",{class:"text-secondary",for:"rememberMe"},"Remember Me")," \xa0",r.a.createElement("a",{href:"/register"},"Need to Register?"))))))};var D=function(){var e=g(),t=Object(i.a)(e,2),a=t[0],c=t[1];function s(){return(s=Object(v.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[logoutRequest] attempting to logout..."),e.next=3,w.post("/api/user/logout",{});case 3:if(t=e.sent,console.log("apiResult: ",t),!t.error){e.next=8;break}return c({do:"setMessage",type:"danger",message:t.error}),e.abrupt("return");case 8:c({do:"setMessage",type:"success",message:"Logged out..."}),localStorage.session="",setTimeout((function(){c({do:"loginState",loggedIn:!1})}),3e3);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){!function(){s.apply(this,arguments)}()}),[]),r.a.createElement("div",null,a.loggedIn?"":r.a.createElement(l.a,{to:"/login"}),"\\            ",r.a.createElement("section",{class:"jumbotron text-center"},r.a.createElement("div",{class:"container"},r.a.createElement("p",{class:"lead text-muted"},"Please wait, logging out..."))))};var J=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"footer-padding"}),r.a.createElement("div",{id:"footer"},"(c) 2020 The Everest Team"))};var U=function(){return r.a.createElement(o.a,null,r.a.createElement(p,null," ",r.a.createElement("div",{className:"App"},r.a.createElement(y,null),r.a.createElement("div",{class:"container"},r.a.createElement(l.b,{exact:!0,path:["/","/productlist"],component:x}),r.a.createElement(l.b,{path:"/productinfo/:id",component:N}),r.a.createElement(l.b,{exact:!0,path:"/productadd",component:C}),r.a.createElement(l.b,{exact:!0,path:"/cart",component:T}),r.a.createElement(l.b,{exact:!0,path:"/register",component:L}),r.a.createElement(l.b,{exact:!0,path:"/login",component:_}),r.a.createElement(l.b,{exact:!0,path:"/logout",component:D}),r.a.createElement(l.b,{exact:!0,path:"/settings",component:M})),r.a.createElement(J,null))))};s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(U,null)),document.getElementById("root"))}},[[22,1,2]]]);
//# sourceMappingURL=main.5835c30c.chunk.js.map